# NeuronMotif

This repository implements the methods in ["NeuronMotif: Deciphering cis-regulatory codes by layerwise de-mixing of deep neural networks"](https://www.biorxiv.org/content/10.1101/2021.02.10.430606v1) by Zheng Wei, Kui Hua, Lei Wei, Shining Ma, Rui Jiang, Yanda Li, Wing Hung Wong, Xiaowo Wang.


The code for training deep convolutional neural network (DCNN) models that used in this work are stored in [dcnn](https://github.com/wzthu/NeuronMotif/tree/master/dcnn).

The code implements NeuronMotif algorithm for decoupling the mentioned DCNN **once** are stored in [nm](https://github.com/wzthu/NeuronMotif/tree/master/nm). It also includes interpreting and visualizing codes.

The code implements NeuronMotif algorithm for decoupling the mentioned DCNN **twice** are stored in [nm-2](https://github.com/wzthu/NeuronMotif/tree/master/nm-2). It depends on the sequence sampling result  generated by the code in [nm](https://github.com/wzthu/NeuronMotif/tree/master/nm). It also includes interpreting and visualizing codes. 

The code of NeuronMotif does not depend on GPU. We have parallelized the code so that it can make full use of the computing resources in a computer cluster.

If you are interested in a part of the work, you can read README file in the corresponding folder for the instruction of downloading the data and running the code.

# Introduction of NeuronMotif

NeuronMotif is an algorithm for interpreting the patterns learned by deep convolutional neurons(DCN) in DCNN. For a DCNN based on DNA sequences, it can convert the substructure weight of a DCN into DNA sequence motifs. DNA can be considered a new language so the task of NeuronMotif is to uncover the motif and motif grammar embedded in DCNs.

# Results of NeuronMotif

Result is available at [NeuronMotif website](https://wzthu.github.io/NeuronMotif/).

# Installation

## Install anaconda

Download and install (anaconda)[https://www.anaconda.com/products/individual].

## Create the  NeuronMotif environment

NeuronMotif is implemented and tested in python 3.6.

```
conda create -n NeuronMotif python=3.6
```

## Install dependent packages

```
conda activate NeuronMotif
pip install h5py==2.10.0
pip install matplotlib
pip install pandas
pip install numpy
pip install sklearn
pip install tensorflow==1.15.0
pip install keras==2.3.1

```


## Install visualization dependences

Download and install meme-suit to get tomtom first:

version: 5.1.0, later version does not support >100 bp receptive field.

https://meme-suite.org/meme/meme-software/5.1.0/meme-5.1.0.tar.gz
https://meme-suite.org/meme/tools/tomtom

and add it to PATH environment variable or execute

```
export PATH=/path/to/meme/bin:/path/to/meme:/path/to/meme/libexec/meme-x.x.0:$PATH
```

Test following commands:

```
tomtom -h
```
and

```
chen2meme  -h
```


## Ready to use

This command line should be executed every time you enter the terminal before using NeuronMotif

```
conda activate NeuronMotif
```
